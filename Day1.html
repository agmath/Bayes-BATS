<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Gilbert">
<meta name="dcterms.date" content="2024-07-15">

<title>Bayes-BATS (Day 1)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Day1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Day1_files/libs/quarto-html/quarto.js"></script>
<script src="Day1_files/libs/quarto-html/popper.min.js"></script>
<script src="Day1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Day1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Day1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Day1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Day1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Day1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Day1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Day1_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="Day1_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#morning-session" id="toc-morning-session" class="nav-link active" data-scroll-target="#morning-session">Morning Session</a>
  <ul class="collapse">
  <li><a href="#what-is-bayesian-statistics" id="toc-what-is-bayesian-statistics" class="nav-link" data-scroll-target="#what-is-bayesian-statistics">What is Bayesian Statistics?</a></li>
  <li><a href="#assumptions-in-bayesian-analyses" id="toc-assumptions-in-bayesian-analyses" class="nav-link" data-scroll-target="#assumptions-in-bayesian-analyses">Assumptions in Bayesian Analyses</a></li>
  <li><a href="#interpretations" id="toc-interpretations" class="nav-link" data-scroll-target="#interpretations">Interpretations</a></li>
  <li><a href="#same-data-different-priors" id="toc-same-data-different-priors" class="nav-link" data-scroll-target="#same-data-different-priors">Same Data, Different Priors</a></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a></li>
  <li><a href="#probability-review" id="toc-probability-review" class="nav-link" data-scroll-target="#probability-review">Probability Review</a>
  <ul class="collapse">
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes Rule</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#discrete-probability-models" id="toc-discrete-probability-models" class="nav-link" data-scroll-target="#discrete-probability-models">Discrete Probability Models</a>
  <ul class="collapse">
  <li><a href="#an-example-phd-admissions" id="toc-an-example-phd-admissions" class="nav-link" data-scroll-target="#an-example-phd-admissions">An Example: PhD Admissions</a></li>
  <li><a href="#the-binomial-model" id="toc-the-binomial-model" class="nav-link" data-scroll-target="#the-binomial-model">The Binomial Model</a></li>
  <li><a href="#summary-steps-of-bayesian-analysis" id="toc-summary-steps-of-bayesian-analysis" class="nav-link" data-scroll-target="#summary-steps-of-bayesian-analysis">Summary: Steps of Bayesian Analysis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#after-the-morning-break" id="toc-after-the-morning-break" class="nav-link" data-scroll-target="#after-the-morning-break">After the Morning Break</a>
  <ul class="collapse">
  <li><a href="#beta-descriptives" id="toc-beta-descriptives" class="nav-link" data-scroll-target="#beta-descriptives">Beta Descriptives</a></li>
  <li><a href="#grad-admissions-example" id="toc-grad-admissions-example" class="nav-link" data-scroll-target="#grad-admissions-example">Grad Admissions Example</a></li>
  <li><a href="#posterior-for-the-beta-binomial-model" id="toc-posterior-for-the-beta-binomial-model" class="nav-link" data-scroll-target="#posterior-for-the-beta-binomial-model">Posterior for the Beta-Binomial Model</a></li>
  <li><a href="#an-update-to-the-grad-program-admissions-example" id="toc-an-update-to-the-grad-program-admissions-example" class="nav-link" data-scroll-target="#an-update-to-the-grad-program-admissions-example">An Update to the Grad Program Admissions Example</a></li>
  <li><a href="#bechdel-test-example" id="toc-bechdel-test-example" class="nav-link" data-scroll-target="#bechdel-test-example">Bechdel Test Example</a></li>
  <li><a href="#sequential-updating" id="toc-sequential-updating" class="nav-link" data-scroll-target="#sequential-updating">Sequential Updating</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bayes-BATS (Day 1)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Adam Gilbert </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 15, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="morning-session" class="level1">
<h1>Morning Session</h1>
<section id="what-is-bayesian-statistics" class="level2">
<h2 class="anchored" data-anchor-id="what-is-bayesian-statistics">What is Bayesian Statistics?</h2>
<p>In Bayesian Statistics, we use a prior expectation (a distribution) and data which come together to generate a posterior. We can then use the posterior as the new prior and combine it with new data to obtain an updated prior. We continue doing this as new data comes in.</p>
<p>This is as opposed to the Frequentist approach where the data determines everything.</p>
</section>
<section id="assumptions-in-bayesian-analyses" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-in-bayesian-analyses">Assumptions in Bayesian Analyses</h2>
<p>We make choices that determine how much weight is applied to the prior versus the data in the creation of the posterior distribution. The weight attached to the prior is determined by the distribution and its parameters. For example, in the case of a <em>normal</em> prior, we can choose a large standard deviation if we are uncertain about our prior estimate (and/or we know that we have high quality data) and a small standard deviation if we are more certain about the prior.</p>
</section>
<section id="interpretations" class="level2">
<h2 class="anchored" data-anchor-id="interpretations">Interpretations</h2>
<p>Bayesians interpret probability as a measure of the relative plausibility of an event. Frequentists interpret probability as a measure of the long-run relative frequency of a repeatable event.</p>
</section>
<section id="same-data-different-priors" class="level2">
<h2 class="anchored" data-anchor-id="same-data-different-priors">Same Data, Different Priors</h2>
<p>We have the following scenarios. Both have the same data (ten successes out of ten trials), but we intuitively have different priors.</p>
<p><strong>Example 1:</strong> Kaya claims that they can predict the outcome of a coin flip. To test their claim, you flip a fair coin 10 times and they correctly predict all 10.</p>
<p><strong>Example 2:</strong> Fan claims that they can distinguish natural and artificial sweetners. To test their claim, you give them 10 sweetner samples and they correctly identify each.</p>
<p>We do not believe that Kaya can predict the outcome of a coin flip because our prior is strongly against this hypothesis.</p>
</section>
<section id="hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Discussion Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose that during a recent doctor’s visit, you tested positive for a very rare disease. If you only get to ask the doctor one question, which would it be?</p>
<ol type="1">
<li>What is the chance that I actually have the disease? <span class="math inline">\(\displaystyle{\left(\mathcal{P}\left[\text{disease} | +\right]\right)}\)</span></li>
<li>If I don’t have the disease, what is the probability that I tested positive? <span class="math inline">\(\displaystyle{\left(\mathcal{P}\left[+ | \text{disease}^c\right]\right)}\)</span></li>
</ol>
</div>
</div>
</section>
<section id="probability-review" class="level2">
<h2 class="anchored" data-anchor-id="probability-review">Probability Review</h2>
<p>Consider the following two-way table on mammogram results.</p>
<center>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Cancer</strong></th>
<th><strong>No Cancer</strong></th>
<th><strong>Total</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mammo+</td>
<td>85</td>
<td>990</td>
<td>1075</td>
</tr>
<tr class="even">
<td>Mammo-</td>
<td>15</td>
<td>8910</td>
<td>8925</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>100</td>
<td>9900</td>
<td>10000</td>
</tr>
</tbody>
</table>
</center>
<p>Let <span class="math inline">\(A\)</span> represent the event that a mammogram is positive for breast cancer, ansd <span class="math inline">\(B\)</span> represent the event that a woman has cancer.</p>
<ol type="1">
<li><span class="math inline">\(\mathcal{P}\left[\text{Cancer}\right] = \frac{100}{10000} = 1\%\)</span> is called the <em>marginal</em> probability of <span class="math inline">\(\text{Cancer}\)</span> since we can calculate the probability using only the aggregate numbers in the “margins” of the table.</li>
<li><span class="math inline">\(\mathcal{P}\left[\text{Cancer and }+\right] = \frac{85}{10000} = 0.85\%\)</span> is called a <em>joint</em> probability since it is the probability of two things happening simultaneously.</li>
<li><span class="math inline">\(\mathcal{P}\left[\text{Cancer} | +\right] = \frac{85}{1075} \approx 7.9\%\)</span> is called a conditional probability.</li>
</ol>
<section id="bayes-rule" class="level3">
<h3 class="anchored" data-anchor-id="bayes-rule">Bayes Rule</h3>
<p>Consider the breast cancer screening example above. Suppose that a 40 year old woman, Maya, goes to a clinic for a screening. Assume further that the prevalence of cancer for 40 year old women is 1%. From the example above, we see that Maya’s likelihood of having cancer has risen. What is the likelihood that Maya has cancer?</p>
<p><span class="math display">\[\begin{align} \mathcal{P}\left[\text{cancer} | +\right] &amp;= \frac{\mathcal{P}\left[+ | \text{cancer}\right]\cdot\mathcal{P}\left[\text{cancer}\right]}{\mathcal{P}\left[+ | \text{cancer}\right]\cdot\mathcal{P}\left[\text{cancer}\right] + \mathcal{P}\left[\text{cancer}^c | +\right]}\\
&amp;= \frac{0.85\cdot\left(0.01\right)}{\left(0.85\cdot\left(0.01\right)\right) + \left(0.1\cdot\left(0.99\right)\right)}\\
&amp;= \boxed{~0.079~~\text{or about }7.9\%~}
\end{align}\]</span></p>
<p>We can call these quantities likelihoods, as they compare the likelihood of a positive mammogram under the two scenarios. Notation can be confusing, as <span class="math inline">\(L\left(⋅∣A\right)=\mathcal{P}\left(A∣⋅\right)\)</span>.</p>
<p>L(B∣A)=P(A∣B)=0.85 (our data of a positive mammogram are highly compatible with cancer)</p>
<p>L(BC∣A)=P(A∣BC)=0.10 (data of a positive mammogram are less compatible with no cancer)</p>
<p>When a woman has breast cancer, we are much more likely to get the data of a positive mammogram than we are when a woman is cancer-free. Still, cancer is not common.</p>
<blockquote class="blockquote">
<p>COME BACK AND FILL IN LATER…</p>
</blockquote>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p><span class="math display">\[\mathcal{P}\left[B | A\right] = \frac{\mathcal{P}\left(B\right)\cdot L\left(B | A\right)}{\mathcal{P}\left(A\right)}\]</span></p>
<p><span class="math display">\[\text{posterior} = \frac{\text{prior}\times\text{likelihood}}{\text{marginal probability}}\]</span></p>
<p><span class="math display">\[\text{posterior} = \frac{\text{pior}\times\text{likelihood}}{\text{normalizing constant}}\]</span></p>
</section>
<section id="discrete-probability-models" class="level2">
<h2 class="anchored" data-anchor-id="discrete-probability-models">Discrete Probability Models</h2>
<p>Let <span class="math inline">\(Y\)</span> be a discrete random variable with probability mass function (<span class="math inline">\(\text{pmf}\)</span>) <span class="math inline">\(f\left(y\right)\)</span>. Then the <span class="math inline">\(\text{pmf}\)</span> defines the probability of any given <span class="math inline">\(y\)</span> as <span class="math inline">\(f\left(y\right) = \mathcal{P}\left[Y = y\right]\)</span> with the following properties:</p>
<ul>
<li><span class="math inline">\(\sum_{y\in Y}{f\left(y\right)} = 1\)</span></li>
<li><span class="math inline">\(0\leq f\left(y\right) \leq 1\)</span></li>
</ul>
<section id="an-example-phd-admissions" class="level3">
<h3 class="anchored" data-anchor-id="an-example-phd-admissions">An Example: PhD Admissions</h3>
<p>Let <span class="math inline">\(Y\)</span> be a random variable that represents the number of applicants admitted to a PhD program that has received applications from 5 prospective students. That is, <span class="math inline">\(\Omega_y = \{0,1,2,3,4,5\}\)</span>. We are interested in the parameter <span class="math inline">\(\pi\)</span>, which represents the probability of acceptance to this program. For demonstrative purposes, we will only consider three possible values of <span class="math inline">\(\pi:~0.2,~0.4,~\text{and}~0.8\)</span>., where the prior distribution on the probabilities is as follows:</p>
<center>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(\pi\)</span></th>
<th>0.2</th>
<th>0.4</th>
<th>0.8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(f\left(\pi\right)\)</span></td>
<td>0.7</td>
<td>0.2</td>
<td>0.1</td>
</tr>
</tbody>
</table>
</center>
<p>Given this prior, what is the likelihood pf each of the admission probabilities if…</p>
<ul>
<li>all five applicants were admitted?</li>
<li>none of the five applicants were admitted?</li>
</ul>
</section>
<section id="the-binomial-model" class="level3">
<h3 class="anchored" data-anchor-id="the-binomial-model">The Binomial Model</h3>
<p>In the example above, the admission variable is modeled by a binomial model with probability of admission equal to <span class="math inline">\(\pi\)</span>. That is,</p>
<p><span class="math display">\[Y | \pi \sim \text{Bin}\left(n, \pi\right)\]</span></p>
<p>Here we have the conditional probability mass function:</p>
<p><span class="math display">\[f\left(y | \pi\right) = \binom{n}{y}\pi^y\left(1 - \pi\right)^{n - y} \text{ for } y \in \left\{0, 1, 2, 3, 4, 5\right\}\]</span></p>
<p>We can examine the probabilities of number of admits given our plausible admissions probabilities.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>admit_results <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pi =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="fl">0.4</span>, <span class="dv">6</span>), <span class="fu">rep</span>(<span class="fl">0.8</span>, <span class="dv">6</span>)),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">admits =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fu">dbinom</span>(admits, <span class="dv">5</span>, pi)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>admit_results <span class="sc">%&gt;%</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> admits, <span class="at">y =</span> prob)) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> admits, <span class="at">xend =</span> admits, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> prob)) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pi, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Day1_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s assume that we’ve admitted three of the five applicants. The plot below shows the probabilities given the acceptance results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>admit_results <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(admits <span class="sc">==</span> <span class="dv">3</span>, <span class="st">"red"</span>, <span class="st">"black"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> admits, <span class="at">y =</span> prob, <span class="at">color =</span> color)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> admits, <span class="at">xend =</span> admits, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> prob, <span class="at">color =</span> color)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"None"</span>) <span class="sc">+</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pi, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Day1_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now lets compute the likelihood, <span class="math inline">\(L\left(\pi | \left(y = 3\right)\right)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>admit_results <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(admits <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> pi, <span class="at">y =</span> prob), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> pi, <span class="at">xend =</span> pi, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> prob), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(\pi)"</span>),</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Likelihood"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Day1_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>COME BACK LATER AND WORK THROUGH EXAMPLE IN SLIDE DECK</p>
</blockquote>
</section>
<section id="summary-steps-of-bayesian-analysis" class="level3">
<h3 class="anchored" data-anchor-id="summary-steps-of-bayesian-analysis">Summary: Steps of Bayesian Analysis</h3>
<p>Every Bayesian analysis consists of three common steps.</p>
<p>1.Construct a prior model for your variable of interest, <span class="math inline">\(\pi\)</span>. A prior model specifies two important pieces of information: the possible values of <span class="math inline">\(\pi\)</span> and the relative prior plausibility of each.</p>
<p>2.Upon observing data <span class="math inline">\(Y = y\)</span>, define the likelihood function <span class="math inline">\(L\left(\pi | y\right)\)</span>. As a first step, we summarize the dependence of <span class="math inline">\(Y\)</span> on <span class="math inline">\(\pi\)</span> via a conditional probability mass function <span class="math inline">\(f\left(y | \pi\right)\)</span>. The likelihood function is then defined by <span class="math inline">\(L\left(\pi | y\right) = f\left(y | \pi\right)\)</span> and can be used to compare the relative likelihood of different <span class="math inline">\(\pi\)</span> values in light of data <span class="math inline">\(Y = y\)</span>.</p>
<ol start="3" type="1">
<li>Build the <strong>posterior model</strong> of <span class="math inline">\(\pi\)</span> via Bayes’ Rule. By Bayes’ Rule, the posterior model is constructed by balancing the prior and the likelihood:</li>
</ol>
<p><span class="math display">\[\text{posterior} = \frac{\text{prior} \cdot\text{likelihood}}{\text{normalizing constant}} \propto \text{prior}\cdot\text{likelihood}\]</span></p>
<p>More technically,</p>
<p><span class="math display">\[f\left(\pi | y\right) = \frac{f\left(\pi\right)\cdot L\left(\pi | y\right)}{f\left(y\right)} \propto f\left(\pi\right)\cdot L\left(\pi | y\right)\]</span></p>
</section>
</section>
</section>
<section id="after-the-morning-break" class="level1">
<h1>After the Morning Break</h1>
<p>Let’s make the previous example more realistic. The admission rate <span class="math inline">\(\pi\)</span> is a continuous random variable. Then we have the following:</p>
<ul>
<li><span class="math inline">\(\int_{\pi}{f\left(\pi\right)d\pi} = 1\)</span></li>
<li><span class="math inline">\(f\geq 0\)</span></li>
<li><span class="math inline">\(\mathcal{P}\left[a &lt; \pi &lt; b\right] = \int_{a}^{b}{f\left(\pi\right)d\pi}\)</span> when <span class="math inline">\(a \leq b\)</span>.</li>
</ul>
<p>Consider the following individuals who all have different priors.</p>
<ul>
<li>Katie thinks that it is extremely difficult to get into this program.</li>
<li>Sha’Carri thinks that it is difficult to get into this program.</li>
<li>Caeleb does not have any strong opinions whether it is difficult or easy to get into this program.</li>
<li>Sunisa thinks that it is easy to get into this program.</li>
<li>Simone thinks that it is extremely easy to get into this program.</li>
</ul>
<p>Katie’s prior puts lots of the probability mass towards low probabilities of admission. Caeleb has a uniform prior. We can use the <strong>Beta Prior Model</strong> to describe each of the prior distributions for our individuals.</p>
<p><span class="math display">\[\pi \sim \text{Beta}\left(\alpha, \beta\right)\]</span></p>
<p>The Beta model is specified by the following continuous pdf:</p>
<p><span class="math display">\[f\left(\pi\right) = \frac{\Gamma\left(\alpha + \beta\right)}{\Gamma\left(\alpha\right)\Gamma\left(\beta\right)}\pi^{\alpha -1}\left(1 - \pi\right)^{\beta - 1}~~\text{for}~~\pi \in\left[0, 1\right]\]</span></p>
<p>The Beta distribution is determined by the two shape parameters, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>beta_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pi =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">9</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">300</span>), <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">300</span>), <span class="fu">rep</span>(<span class="dv">20</span>, <span class="dv">300</span>)),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="dv">20</span>, <span class="dv">100</span>)), <span class="dv">3</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fu">dbeta</span>(pi, alpha, beta)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>beta_tibble <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(label = paste0("Beta(", alpha, beta, ")")) +</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> pi, <span class="at">y =</span> prob)) <span class="sc">+</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(alpha <span class="sc">~</span> beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="beta-descriptives" class="level3">
<h3 class="anchored" data-anchor-id="beta-descriptives">Beta Descriptives</h3>
<p>The following describe the Beta distribution.</p>
<ul>
<li><span class="math inline">\(\mathbb{E}\left[\pi\right] = \frac{\alpha}{\alpha + \beta}\)</span></li>
<li><span class="math inline">\(\text{Model}\left(\pi\right) = \frac{\alpha - 1}{\alpha + \beta - 2}\)</span></li>
<li><span class="math inline">\(\text{Var}\left(\pi\right) = \frac{\alpha\beta}{\left(\alpha + \beta\right)^2\left(\alpha + \beta + 1\right)}\)</span></li>
</ul>
</section>
<section id="grad-admissions-example" class="level3">
<h3 class="anchored" data-anchor-id="grad-admissions-example">Grad Admissions Example</h3>
<p>An applicant to a small graduate program wants to know <span class="math inline">\(\pi\)</span>, the probability of admission, so they can determine how many programs to which they should apply. Based on commentary on The <em>GradCafe</em> about similar programs, the applicant thinks that <span class="math inline">\(\pi\)</span> is likely to be in the range of <span class="math inline">\(0.05\)</span> to <span class="math inline">\(0.25\)</span>.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Discussion Question
</div>
</div>
<div class="callout-body-container callout-body">
<p>Is the distribution below a reasonable choice of prior, given the description above?</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_beta</span>(<span class="dv">5</span>, <span class="dv">35</span>) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Day1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can summarize the prior easily with R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_beta</span>(<span class="dv">5</span>, <span class="dv">35</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"hover"</span>, <span class="st">"striped"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-hover table-striped caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mode</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">var</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.1052632</td>
<td style="text-align: right;">0.0026677</td>
<td style="text-align: right;">0.0516496</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="posterior-for-the-beta-binomial-model" class="level3">
<h3 class="anchored" data-anchor-id="posterior-for-the-beta-binomial-model">Posterior for the Beta-Binomial Model</h3>
<p>Let <span class="math inline">\(\pi\sim \text{Beta}\left(\alpha, \beta\right)\)</span> and <span class="math inline">\(Y | n \sim \text{Bin}\left(n, \pi\right)\)</span>. Then,</p>
<ul>
<li><span class="math inline">\(f\left(\pi | y\right)\propto \frac{\Gamma\left(\alpha + \beta\right)}{\Gamma\left(\alpha\right)\Gamma\left(\beta\right)}\pi^{\alpha - 1}\left(1 - \pi\right)^{\beta - 1}\binom{n}{y}\pi^y\left(1 - \pi\right)^{n - y}\)</span></li>
<li><span class="math inline">\(f\left(\pi | y\right) \propto \pi^{\left(\alpha + y\right) - 1}\left(1 - \pi\right)^{\left(\beta + n - y\right) - 1}\)</span></li>
<li><span class="math inline">\(\pi | y \sim \text{Beta}\left(\alpha + y, \beta + n - y\right)\)</span></li>
<li><span class="math inline">\(f\left(\pi | y\right) = \frac{\Gamma\left(\alpha + \beta + n\right)}{\Gamma\left(\alpha + y\right)\Gamma\left(\beta + n - y\right)\pi^{\left(\alpha + y\right) - 1}\left(1 - \pi\right)^{\left(\beta + n - y\right) - 1}}\)</span></li>
</ul>
<p>Think of <span class="math inline">\(\alpha\)</span> as the number of prior successes and <span class="math inline">\(\beta\)</span> as the number of prior failures.</p>
<p>We say that <span class="math inline">\(f\left(\pi\right)\)</span> is a <strong>conjugate prior</strong> for <span class="math inline">\(L\left(\pi | y\right)\)</span> if the posterior <span class="math inline">\(f\left(\pi | y\right) \propto f\left(\pi\right)L\left(\pi | y\right)\)</span>. Thus, the Beta distribution is a conjugate prior for the Binomial likelihood model because the posterior also follows a Beta distribution.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Choosing <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that <span class="math inline">\(\alpha\)</span> is often interpreted as the approximate prior number of successes, and <span class="math inline">\(\beta\)</span> is often interpreted as the approximate prior number of failures, with <span class="math inline">\(\alpha + \beta\)</span> as the approximate prior sample size.</p>
</div>
</div>
</section>
<section id="an-update-to-the-grad-program-admissions-example" class="level3">
<h3 class="anchored" data-anchor-id="an-update-to-the-grad-program-admissions-example">An Update to the Grad Program Admissions Example</h3>
<p>The applicant decides to collect some data on social media and identifies 50 people who applied to the program and asks them whether they were accepted or not. It turns out that 25 of them were! What is the posterior distribution of <span class="math inline">\(\pi\)</span> after having observed this data?</p>
<p><span class="math display">\[\begin{align} \pi | y &amp;\sim \text{Beta}\left(\alpha + \beta, \beta + n - y\right)\\
\pi | y &amp;\sim \text{Beta}\left(5 + 25, 35 + 50 - 25\right)\\
\pi | y &amp;\sim \text{Beta}\left(30, 60\right)\\
\end{align}\]</span></p>
<p>This follows from multiplying the prior and the likelihood function together, where the bases (<span class="math inline">\(\pi\)</span> and <span class="math inline">\(1 - \pi\)</span>) are common within the two mathematical models and so we sum the exponents.</p>
</section>
<section id="bechdel-test-example" class="level2">
<h2 class="anchored" data-anchor-id="bechdel-test-example">Bechdel Test Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"optimist"</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="st">"neutral"</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="st">"pessimist"</span>, <span class="dv">100</span>)),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pi =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>), <span class="dv">3</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">14</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">100</span>)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>), <span class="fu">rep</span>(<span class="dv">11</span>, <span class="dv">100</span>)),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fu">dbeta</span>(pi, alpha, beta)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>priors <span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">x =</span> pi, <span class="at">y =</span> prob, <span class="at">fill =</span> type),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Day1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">84735</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>bechdel_samp <span class="ot">&lt;-</span> bechdel <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">20</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>bechdel_samp <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(binary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  binary     n
  &lt;chr&gt;  &lt;int&gt;
1 FAIL      11
2 PASS       9</code></pre>
</div>
</div>
</section>
<section id="sequential-updating" class="level2">
<h2 class="anchored" data-anchor-id="sequential-updating">Sequential Updating</h2>
<p>With basic sequential updating, the order in which we observe the subsets of data does not impact the final posterior model. In fact, it doesn’t matter if we observe all of the data at once. If we do want to weight recent data more heavily than older data, we’ll need to use something other than sequential updating.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>